package eu.occtet.boc.vulnerability.model.vulnerablecode;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;

import java.util.List;

@JsonIgnoreProperties(ignoreUnknown = true)
public record PackageResultDto(
        // general package data
        String url,
        String purl,
        String type,
        String namespace,
        String name,
        String version,
        String subpath,

        // Vulnerability data
        @JsonProperty("is_vulnerable") Boolean isVulnerable,
        @JsonProperty("next_non_vulnerable_version") String nextNonVulnerableVersion,
        @JsonProperty("latest_non_vulnerable_version") String latestNonVulnerableVersion,
        // located vulnerabilities that still affect this package
        @JsonProperty("affected_by_vulnerabilities") List<VulnerabilityDto> affectedByVulnerabilities,
        // located vulnerabilities that do not affect this package no more
        @JsonProperty("fixing_vulnerabilities") List<VulnerabilityDto> fixingVulnerabilities,
        @JsonProperty("risk_score") Double riskScore,
        @JsonProperty("resource_url") String resourceUrl)
{ }
