<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (C) 2025 Bitsea GmbH
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     https:www.apache.orglicensesLICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  ~ SPDX-License-Identifier: Apache-2.0
  ~ License-Filename: LICENSE
  -->

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS"   >
    <changeSet id="1" author="OcctetFrontend" runAlways="true">
        <createTable tableName="DBLOG" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DBLOG"/>
            </column>
            <column name="EVENT_DATE" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="COMPONENT" type="VARCHAR(50)"/>
            <column name="MESSAGE" type="TEXT"/>
        </createTable>


        <createTable tableName="PROJECT" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PROJECT"/>
            </column>
            <column name="PROJECT_NAME" type="VARCHAR(255)"/>
            <column name="BASEPATH" type="text"/>
        </createTable>
        <createTable tableName="SCANNER_INITIALIZER" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SCANNER_INITIALIZER"/>
            </column>
            <column name="SCANNER" type="varchar(255)"/>
            <column name="STATUS" type="VARCHAR(255)"/>
            <column name="FEEDBACK" type="TEXT"/>
            <column name="PROJECT_ID" type="UUID"/>
            <column name="LAST_UPDATE" type="date"/>
        </createTable>
        <createTable tableName="INVENTORY_ITEM" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_INVENTORY_ITEM"/>
            </column>
            <column name="PROJECT_ID" type="UUID"/>
            <column name="PARENT_INVENTORY_ITEM_ID" type="UUID"/>
            <column name="INVENTORY_NAME" type="TEXT"/>
            <column name="SIZE" type="INTEGER"/>
            <column name="LINKING" type="varchar(255)"/>
            <column name="EXTERNAL_NOTES" type="TEXT"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"/>
            <column name="WAS_COMBINED" type="BOOLEAN"/>
            <column name="CREATED_AT" type="DATE"/>
            <column name="SPDX_ID" type="varchar(255)"/>
            <column name="PRIORITY" type="INTEGER"/>
            <column name="CONSPICUOUS" type="BOOLEAN"/>
        </createTable>

        <createTable tableName="LICENSE" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_LICENSE"/>
            </column>
            <column name="PRIORITY" type="INTEGER"/>
            <column name="LICENSE_TYPE" type="VARCHAR(255)"/>
            <column name="LICENSE_TEXT" type="TEXT"/>
            <column name="LICENSE_NAME" type="VARCHAR(255)"/>
            <column name="DETAILS_URL" type="VARCHAR(255)"/>
            <column name="MODIFIED" type="BOOLEAN"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="IS_SPDX" type="BOOLEAN"/>
            <column name="COPYRIGHT_ID" type="UUID"/>
        </createTable>

        <createTable tableName="SOFTWARE_COMPONENT" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SOFTWARE_COMPONENT"/>
            </column>
            <column name="SOFTWARE_COMPONENT_NAME" type="VARCHAR(255)"/>
            <column name="VERSION" type="varchar(255)"/>
            <column name="PURL" type="varchar(255)"/>
            <column name="LICENSE_AI_CONTROLLED" type="BOOLEAN"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="DETAILS_URL" type="TEXT"/>
        </createTable>

        <createTable tableName="CODE_LOCATION" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CODE_LOCATION" />
            </column>
            <column name="FILE_PATH" type="TEXT"/>
            <column name="INVENTORY_ITEM_ID" type="uuid"/>
            <column name="COPYRIGHT_ID" type="uuid"/>
            <column name="LINE_NUMBER" type="INTEGER"/>
            <column name="LINE_NUMBER_TO" type="INTEGER"/>
        </createTable>
        <createTable tableName="CONFIGURATION" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CONFIGURATION"/>
            </column>
            <column name="NAME" type="varchar(255)"/>
            <column name="VALUE" type="varchar(255)"/>
            <column name="UPLOAD" type="binary"/>
            <column name="SCANNER_INITIALIZER_ID" type="UUID"/>
        </createTable>
        <createTable tableName="SOFTWARE_COMPONENT_LICENSE_LINK" ifNotExists="true">
            <column name="SOFTWARE_COMPONENT_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="2" author="OcctetFrontend" runAlways="true">
        <createTable tableName="VULNERABILITY" ifNotExists="true">
            <column name="ID" type="uuid">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="VULNERABILITY_ID" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="SUMMARY" type="TEXT"/>
            <column name="ALIASES" type="TEXT"/>
            <column name="WEIGHTED_SEVERITY" type="FLOAT"/>
            <column name="EXPLOITABILITY" type="FLOAT"/>
            <column name="RISK_SCORE" type="FLOAT"/>
            <column name="FIXED_PACKAGES" type="TEXT"/>
            <column name="SOURCE_URL" type="varchar(255)"/>
            <column name="REFRENCE_URLS" type="TEXT"/>
            <column name="CREATED_AT" type="DATE">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="SOFTWARE_COMPONENT_VULNERABILITY_LINK" ifNotExists="true">
            <column name="SOFTWARE_COMPONENT_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="VULNERABILITY_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="VEX_DATA" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_VEX_DATA" />
            </column>
            <column name="TITLE" type="TEXT"/>
            <column name="CHECKED" type="BOOLEAN"/>
            <column name="BOM_FORMAT" type="TEXT"/>
            <column name="SPEC_VERSION" type="TEXT"/>
            <column name="SERIAL_NUMBER" type="TEXT"/>
            <column name="VERSION" type="INTEGER"/>
            <column name="TIME_STAMP" type="DATE"/>
            <column name="META_DATA" type="TEXT"/>
            <column name="VULNERABILITIES" type="TEXT"/>
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"/>
        </createTable>
        <createTable tableName="VULNERABILITY_VEX_LINK" ifNotExists="true">
            <column name="VEX_DATA_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="VULNERABILITY_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="FILE" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_FILE"/>
            </column>
            <column name="PROJECT_ID" type="UUID">
                <constraints nullable="false"
                             foreignKeyName="FK_FILE_PROJECT"
                             references="PROJECT(ID)"
                             deleteCascade="true"/>
            </column>
            <column name="PARENT_ID" type="UUID">
                <constraints nullable="true"
                             foreignKeyName="FK_FILE_PARENT"
                             references="FILE(ID)"
                             deleteCascade="true"/>
            </column>
            <column name="CODE_LOCATION_ID" type="UUID">
                <constraints nullable="true"
                             foreignKeyName="FK_FILE_CODE_LOCATION"
                             references="CODE_LOCATION(ID)"/>
            </column>
            <column name="INVENTORY_ITEM_ID" type="UUID">
                <constraints nullable="true"
                             foreignKeyName="FK_FILE_INVENTORY_ITEM"
                             references="INVENTORY_ITEM(ID)"/>
            </column>
            <column name="FILENAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="ABSOLUTE_PATH" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="RELATIVE_PATH" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="IS_DIRECTORY" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="REVIEWED" type="BOOLEAN" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="CREATED_DATE" type="DATETIME"/>
            <column name="LAST_MODIFIED_DATE" type="DATETIME"/>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="3" author="OcctetFrontend" runAlways="true">
        <sql>
            CREATE INDEX IF NOT EXISTS IDX_FILE_PARENT ON public.FILE (PARENT_ID);
            CREATE INDEX IF NOT EXISTS IDX_FILE_PROJECT_PARENT ON public.FILE (PROJECT_ID, PARENT_ID);
            CREATE INDEX IF NOT EXISTS IDX_FILE_PROJECT_REVIEWED ON public.FILE (PROJECT_ID, REVIEWED);
        </sql>


    </changeSet>

    <changeSet id="8" author="db">
        <createTable tableName="COPYRIGHT" ifNotExists="true">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_COPYRIGHT"/>
            </column>
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="GARBAGE" type="BOOLEAN"/>
            <column name="AI_CONTROLLED" type="BOOLEAN"/>
        </createTable>
        <createTable tableName="COPYRIGHT_CODE_LOCATION_LINK" ifNotExists="true">
            <column name="COPYRIGHT_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="CODE_LOCATION_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="9" author="">
        <createTable tableName="SUGGESTION">
            <column name="ID" type="UUID">
            </column>
            <column name="CONTEXT" type="varchar(255)"/>
            <column name="SENTENCE" type="text"/>
        </createTable>
    </changeSet>

    <changeSet id="10-spdx-v2-core-entities" author="OcctetBackend">

        <createTable tableName="CREATION_INFO_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CREATION_INFO_ENTITY"/>
            </column>
            <column name="CREATED" type="VARCHAR(255)"/>
            <column name="CREATORS" type="TEXT"/>
            <column name="LICENSE_LIST_VERSION" type="VARCHAR(255)"/>
            <column name="COMMENT" type="TEXT"/>
        </createTable>

        <createTable tableName="SPDX_DOCUMENT_ROOT" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SPDX_DOCUMENT_ROOT"/>
            </column>
            <column name="SPDX_ID" type="VARCHAR(255)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="SPDX_VERSION" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="DATA_LICENSE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="COMMENT" type="TEXT"/>
            <column name="DOCUMENT_URI" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="CREATION_INFO_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint baseTableName="SPDX_DOCUMENT_ROOT"
                                 baseColumnNames="CREATION_INFO_ID"
                                 constraintName="FK_SPDX_DOC_CREATION_INFO"
                                 referencedTableName="CREATION_INFO_ENTITY"
                                 referencedColumnNames="ID"/>

        <createTable tableName="SPDX_PACKAGE_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SPDX_PACKAGE_ENTITY"/>
            </column>
            <column name="SPDX_ID" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="DOWNLOAD_LOCATION" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="FILES_ANALYZED" type="BOOLEAN"/>
            <column name="VERSION_INFO" type="TEXT"/>
            <column name="LICENSE_CONCLUDED" type="TEXT"/>
            <column name="LICENSE_DECLARED" type="TEXT"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
            <column name="HOMEPAGE" type="TEXT"/>
            <column name="SUMMARY" type="TEXT"/>
            <column name="DESCRIPTION" type="TEXT"/>
            <column name="ORIGINATOR" type="TEXT"/>
            <column name="SUPPLIER" type="TEXT"/>
            <column name="PACKAGE_VERIFICATION_CODE_VALUE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint baseTableName="SPDX_PACKAGE_ENTITY"
                                 baseColumnNames="SPDX_DOCUMENT_ID"
                                 constraintName="FK_SPDX_PACKAGE_DOC"
                                 referencedTableName="SPDX_DOCUMENT_ROOT"
                                 referencedColumnNames="ID"/>

        <createTable tableName="PACKAGE_LICENSE_INFO_FROM_FILES" ifNotExists="true">
            <column name="PACKAGE_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_INFO_FROM_FILES" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="PACKAGE_LICENSE_INFO_FROM_FILES" baseColumnNames="PACKAGE_ID"
                                 constraintName="FK_PKG_LIC_INFO_PKG" referencedTableName="SPDX_PACKAGE_ENTITY" referencedColumnNames="ID"/>

        <createTable tableName="PACKAGE_FILE_NAMES" ifNotExists="true">
            <column name="PACKAGE_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="FILE_NAME" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="PACKAGE_FILE_NAMES" baseColumnNames="PACKAGE_ID"
                                 constraintName="FK_PKG_FILE_NAMES_PKG" referencedTableName="SPDX_PACKAGE_ENTITY" referencedColumnNames="ID"/>

        <createTable tableName="PACKAGE_VERIFICATION_EXCLUDED_FILES" ifNotExists="true">
            <column name="PACKAGE_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="EXCLUDED_FILE_NAME" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="PACKAGE_VERIFICATION_EXCLUDED_FILES" baseColumnNames="PACKAGE_ID"
                                 constraintName="FK_PKG_VERIF_EXCL_PKG" referencedTableName="SPDX_PACKAGE_ENTITY" referencedColumnNames="ID"/>

        <createTable tableName="SPDX_FILE_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SPDX_FILE_ENTITY"/>
            </column>
            <column name="SPDX_ID" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="FILE_NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_CONCLUDED" type="TEXT"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
        </createTable>

        <addForeignKeyConstraint baseTableName="SPDX_FILE_ENTITY"
                                 baseColumnNames="SPDX_DOCUMENT_ID"
                                 constraintName="FK_SPDX_FILE_DOC"
                                 referencedTableName="SPDX_DOCUMENT_ROOT"
                                 referencedColumnNames="ID"/>

        <createTable tableName="FILE_TYPES" ifNotExists="true">
            <column name="SPDX_FILE_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="FILE_TYPE" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="FILE_TYPES" baseColumnNames="SPDX_FILE_ID"
                                 constraintName="FK_FILE_TYPES_FILE" referencedTableName="SPDX_FILE_ENTITY" referencedColumnNames="ID"/>

        <createTable tableName="FILE_LICENSE_INFO" ifNotExists="true">
            <column name="SPDX_FILE_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_INFO_IN_FILES" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="FILE_LICENSE_INFO" baseColumnNames="SPDX_FILE_ID"
                                 constraintName="FK_FILE_LIC_INFO_FILE" referencedTableName="SPDX_FILE_ENTITY" referencedColumnNames="ID"/>

        <createTable tableName="SNIPPET" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SNIPPET"/>
            </column>
            <column name="SPDX_ID" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="SNIPPET_FROM_FILE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_CONCLUDED" type="TEXT"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
        </createTable>

        <addForeignKeyConstraint baseTableName="SNIPPET"
                                 baseColumnNames="SPDX_DOCUMENT_ID"
                                 constraintName="FK_SNIPPET_DOC"
                                 referencedTableName="SPDX_DOCUMENT_ROOT"
                                 referencedColumnNames="ID"/>

        <createTable tableName="SNIPPET_LICENSES" ifNotExists="true">
            <column name="SNIPPET_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_INFO_IN_SNIPPETS" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="SNIPPET_LICENSES" baseColumnNames="SNIPPET_ID"
                                 constraintName="FK_SNIP_LIC_SNIP" referencedTableName="SNIPPET" referencedColumnNames="ID"/>

        <createTable tableName="SNIPPET_RANGES" ifNotExists="true">
            <column name="SNIPPET_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="START_REFERENCE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="START_OFFSET" type="INT"/>
            <column name="START_LINE_NUMBER" type="INT"/>
            <column name="END_REFERENCE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="END_OFFSET" type="INT"/>
            <column name="END_LINE_NUMBER" type="INT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="SNIPPET_RANGES" baseColumnNames="SNIPPET_ID"
                                 constraintName="FK_SNIP_RANGES_SNIP" referencedTableName="SNIPPET" referencedColumnNames="ID"/>

        <createTable tableName="RELATIONSHIP_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_RELATIONSHIP_ENTITY"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="SPDX_ELEMENT_ID" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="RELATED_SPDX_ELEMENT" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="RELATIONSHIP_TYPE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="COMMENT" type="TEXT"/>
        </createTable>

        <addForeignKeyConstraint baseTableName="RELATIONSHIP_ENTITY"
                                 baseColumnNames="SPDX_DOCUMENT_ID"
                                 constraintName="FK_RELATIONSHIP_DOC"
                                 referencedTableName="SPDX_DOCUMENT_ROOT"
                                 referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="11-spdx-v2-fk-patches" author="OcctetBackend">

        <createTable tableName="ANNOTATION_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_ANNOTATION_ENTITY"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="SPDX_PACKAGE_ID" type="BIGINT"/>
            <column name="SPDX_FILE_ID" type="BIGINT"/>
            <column name="ANNOTATOR" type="VARCHAR(255)"/>
            <column name="ANNOTATION_DATE" type="VARCHAR(255)"/>
            <column name="ANNOTATION_TYPE" type="VARCHAR(255)"/>
            <column name="COMMENT" type="TEXT"/>
        </createTable>

        <createTable tableName="CHECKSUM_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CHECKSUM_ENTITY"/>
            </column>
            <column name="PACKAGE_ID" type="BIGINT"/>
            <column name="FILE_ID" type="BIGINT"/>
            <column name="ALGORITHM" type="VARCHAR(255)"/>
            <column name="CHECKSUM_VALUE" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="EXTERNAL_DOCUMENT_REF_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_EXTERNAL_DOCUMENT_REF_ENTITY"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="EXTERNAL_DOC_ID" type="VARCHAR(255)"/>
            <column name="SPDX_DOCUMENT_URI" type="VARCHAR(255)"/>
            <column name="CHECKSUM_ALGORITHM" type="VARCHAR(255)"/>
            <column name="CHECKSUM_VALUE" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="EXTERNAL_REF_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_EXTERNAL_REF_ENTITY"/>
            </column>
            <column name="PACKAGE_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="REFERENCE_CATEGORY" type="VARCHAR(255)"/>
            <column name="REFERENCE_TYPE" type="VARCHAR(255)"/>
            <column name="REFERENCE_LOCATOR" type="VARCHAR(255)"/>
            <column name="COMMENT" type="TEXT"/>
        </createTable>

        <createTable tableName="EXTRACTED_LICENSING_INFO_ENTITY" ifNotExists="true">
            <column name="ID" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_EXTRACTED_LICENSING_INFO_ENTITY"/>
            </column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="LICENSE_ID" type="VARCHAR(255)"/>
            <column name="EXTRACTED_TEXT" type="TEXT"/>
            <column name="LICENSE_NAME" type="VARCHAR(255)"/>
            <column name="COMMENT" type="TEXT"/>
        </createTable>

        <addForeignKeyConstraint baseTableName="ANNOTATION_ENTITY"
                                 baseColumnNames="SPDX_PACKAGE_ID"
                                 constraintName="FK_ANNOTATION_PACKAGE"
                                 referencedTableName="SPDX_PACKAGE_ENTITY"
                                 referencedColumnNames="ID"/>

        <addForeignKeyConstraint baseTableName="CHECKSUM_ENTITY"
                                 baseColumnNames="PACKAGE_ID"
                                 constraintName="FK_CHECKSUM_PACKAGE"
                                 referencedTableName="SPDX_PACKAGE_ENTITY"
                                 referencedColumnNames="ID"/>

        <addForeignKeyConstraint baseTableName="CHECKSUM_ENTITY"
                                 baseColumnNames="FILE_ID"
                                 constraintName="FK_CHECKSUM_FILE"
                                 referencedTableName="SPDX_FILE_ENTITY"
                                 referencedColumnNames="ID"/>

        <addForeignKeyConstraint baseTableName="EXTERNAL_DOCUMENT_REF_ENTITY"
                                 baseColumnNames="SPDX_DOCUMENT_ID"
                                 constraintName="FK_EXT_DOC_REF_ROOT"
                                 referencedTableName="SPDX_DOCUMENT_ROOT"
                                 referencedColumnNames="ID"/>

        <addForeignKeyConstraint baseTableName="EXTERNAL_REF_ENTITY"
                                 baseColumnNames="PACKAGE_ID"
                                 constraintName="FK_EXT_REF_PACKAGE"
                                 referencedTableName="SPDX_PACKAGE_ENTITY"
                                 referencedColumnNames="ID"/>

        <addForeignKeyConstraint baseTableName="EXTRACTED_LICENSING_INFO_ENTITY"
                                 baseColumnNames="SPDX_DOCUMENT_ID"
                                 constraintName="FK_EXT_LIC_INFO_ROOT"
                                 referencedTableName="SPDX_DOCUMENT_ROOT"
                                 referencedColumnNames="ID"/>
    </changeSet>

    <!-- MODIFICATIONS-->

</databaseChangeLog>