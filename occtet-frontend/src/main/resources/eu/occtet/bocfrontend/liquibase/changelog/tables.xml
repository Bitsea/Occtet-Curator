<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (C) 2025 Bitsea GmbH
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     https:www.apache.orglicensesLICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  ~ SPDX-License-Identifier: Apache-2.0
  ~ License-Filename: LICENSE
  -->

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">

    <changeSet id="DBLOG" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="DBLOG"/></not></preConditions>
        <createTable tableName="DBLOG">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_DBLOG"/>
            </column>
            <column name="EVENT_DATE" type="DATETIME"><constraints nullable="false"/></column>
            <column name="COMPONENT" type="VARCHAR(50)"/>
            <column name="MESSAGE" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="PROJECT" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="PROJECT"/></not></preConditions>
        <createTable tableName="PROJECT">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PROJECT"/>
            </column>
            <column name="PROJECT_NAME" type="VARCHAR(255)"/>
            <column name="BASEPATH" type="TEXT"/>
            <column name="SPDX_DOCUMENT_ID" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="SOFTWARE_COMPONENT" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SOFTWARE_COMPONENT"/></not></preConditions>
        <createTable tableName="SOFTWARE_COMPONENT">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SOFTWARE_COMPONENT"/>
            </column>
            <column name="SOFTWARE_COMPONENT_NAME" type="VARCHAR(255)"/>
            <column name="VERSION" type="VARCHAR(255)"/>
            <column name="PURL" type="VARCHAR(255)"/>
            <column name="LICENSE_AI_CONTROLLED" type="BOOLEAN"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="DETAILS_URL" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="LICENSE" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="LICENSE"/></not></preConditions>
        <createTable tableName="LICENSE">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_LICENSE"/>
            </column>
            <column name="PRIORITY" type="INTEGER"/>
            <column name="LICENSE_TYPE" type="VARCHAR(255)"/>
            <column name="LICENSE_TEXT" type="TEXT"/>
            <column name="LICENSE_NAME" type="VARCHAR(255)"/>
            <column name="DETAILS_URL" type="VARCHAR(255)"/>
            <column name="MODIFIED" type="BOOLEAN"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="IS_SPDX" type="BOOLEAN"/>
            <column name="COPYRIGHT_ID" type="UUID"/>
        </createTable>
    </changeSet>

    <changeSet id="VULNERABILITY" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="VULNERABILITY"/></not></preConditions>
        <createTable tableName="VULNERABILITY">
            <column name="ID" type="UUID"><constraints primaryKey="true" nullable="false"/></column>
            <column name="VULNERABILITY_ID" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="SUMMARY" type="TEXT"/>
            <column name="ALIASES" type="TEXT"/>
            <column name="WEIGHTED_SEVERITY" type="FLOAT"/>
            <column name="EXPLOITABILITY" type="FLOAT"/>
            <column name="RISK_SCORE" type="FLOAT"/>
            <column name="FIXED_PACKAGES" type="TEXT"/>
            <column name="SOURCE_URL" type="VARCHAR(255)"/>
            <column name="REFRENCE_URLS" type="TEXT"/>
            <column name="CREATED_AT" type="DATE"><constraints nullable="false"/></column>
        </createTable>
    </changeSet>

    <changeSet id="SCANNER_INITIALIZER" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SCANNER_INITIALIZER"/></not></preConditions>
        <createTable tableName="SCANNER_INITIALIZER">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SCANNER_INITIALIZER"/>
            </column>
            <column name="SCANNER" type="VARCHAR(255)"/>
            <column name="STATUS" type="VARCHAR(255)"/>
            <column name="FEEDBACK" type="TEXT"/>
            <column name="PROJECT_ID" type="UUID"/>
            <column name="LAST_UPDATE" type="DATE"/>
        </createTable>
    </changeSet>

    <changeSet id="INVENTORY_ITEM" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="INVENTORY_ITEM"/></not></preConditions>
        <createTable tableName="INVENTORY_ITEM">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_INVENTORY_ITEM"/>
            </column>
            <column name="PROJECT_ID" type="UUID"/>
            <column name="PARENT_INVENTORY_ITEM_ID" type="UUID"/>
            <column name="INVENTORY_NAME" type="TEXT"/>
            <column name="SIZE" type="INTEGER"/>
            <column name="LINKING" type="VARCHAR(255)"/>
            <column name="EXTERNAL_NOTES" type="TEXT"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"/>
            <column name="WAS_COMBINED" type="BOOLEAN"/>
            <column name="CREATED_AT" type="DATE"/>
            <column name="SPDX_ID" type="VARCHAR(255)"/>
            <column name="PRIORITY" type="INTEGER"/>
            <column name="CONSPICUOUS" type="BOOLEAN"/>
        </createTable>
    </changeSet>

    <changeSet id="CODE_LOCATION" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="CODE_LOCATION"/></not></preConditions>
        <createTable tableName="CODE_LOCATION">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CODE_LOCATION" />
            </column>
            <column name="FILE_PATH" type="TEXT"/>
            <column name="INVENTORY_ITEM_ID" type="UUID"/>
            <column name="COPYRIGHT_ID" type="UUID"/>
            <column name="LINE_NUMBER" type="INTEGER"/>
            <column name="LINE_NUMBER_TO" type="INTEGER"/>
        </createTable>
    </changeSet>

    <changeSet id="COPYRIGHT" author="db" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="COPYRIGHT"/></not></preConditions>
        <createTable tableName="COPYRIGHT">
            <column name="ID" type="UUID"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_COPYRIGHT"/></column>
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
            <column name="CURATED" type="BOOLEAN" defaultValue="false"/>
            <column name="GARBAGE" type="BOOLEAN"/>
            <column name="AI_CONTROLLED" type="BOOLEAN"/>
        </createTable>
    </changeSet>

    <changeSet id="SOFTWARE_COMPONENT_LICENSE_LINK" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SOFTWARE_COMPONENT_LICENSE_LINK"/></not></preConditions>
        <createTable tableName="SOFTWARE_COMPONENT_LICENSE_LINK">
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"><constraints nullable="false"/></column>
            <column name="LICENSE_ID" type="UUID"><constraints nullable="false"/></column>
        </createTable>
    </changeSet>

    <changeSet id="SOFTWARE_COMPONENT_VULNERABILITY_LINK" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SOFTWARE_COMPONENT_VULNERABILITY_LINK"/></not></preConditions>
        <createTable tableName="SOFTWARE_COMPONENT_VULNERABILITY_LINK">
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"><constraints nullable="false"/></column>
            <column name="VULNERABILITY_ID" type="UUID"><constraints nullable="false"/></column>
        </createTable>
    </changeSet>

    <changeSet id="COPYRIGHT_CODE_LOCATION_LINK" author="db" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="COPYRIGHT_CODE_LOCATION_LINK"/></not></preConditions>
        <createTable tableName="COPYRIGHT_CODE_LOCATION_LINK">
            <column name="COPYRIGHT_ID" type="UUID"><constraints nullable="false"/></column>
            <column name="CODE_LOCATION_ID" type="UUID"><constraints nullable="false"/></column>
        </createTable>
    </changeSet>

    <changeSet id="VEX_DATA" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="VEX_DATA"/></not></preConditions>
        <createTable tableName="VEX_DATA">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_VEX_DATA" />
            </column>
            <column name="TITLE" type="TEXT"/>
            <column name="CHECKED" type="BOOLEAN"/>
            <column name="BOM_FORMAT" type="TEXT"/>
            <column name="SPEC_VERSION" type="TEXT"/>
            <column name="SERIAL_NUMBER" type="TEXT"/>
            <column name="VERSION" type="INTEGER"/>
            <column name="TIME_STAMP" type="DATE"/>
            <column name="META_DATA" type="TEXT"/>
            <column name="VULNERABILITIES" type="TEXT"/>
            <column name="SOFTWARE_COMPONENT_ID" type="UUID"/>
        </createTable>
    </changeSet>

    <changeSet id="VULNERABILITY_VEX_LINK" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="VULNERABILITY_VEX_LINK"/></not></preConditions>
        <createTable tableName="VULNERABILITY_VEX_LINK">
            <column name="VEX_DATA_ID" type="UUID"><constraints nullable="false"/></column>
            <column name="VULNERABILITY_ID" type="UUID"><constraints nullable="false"/></column>
        </createTable>
    </changeSet>

    <changeSet id="FILE" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="FILE"/></not></preConditions>
        <createTable tableName="FILE">
            <column name="ID" type="UUID"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_FILE"/></column>
            <column name="PROJECT_ID" type="UUID"><constraints nullable="false" foreignKeyName="FK_FILE_PROJECT" references="PROJECT(ID)" deleteCascade="true"/></column>
            <column name="PARENT_ID" type="UUID"><constraints nullable="true" foreignKeyName="FK_FILE_PARENT" references="FILE(ID)" deleteCascade="true"/></column>
            <column name="CODE_LOCATION_ID" type="UUID"><constraints nullable="true" foreignKeyName="FK_FILE_CODE_LOCATION" references="CODE_LOCATION(ID)"/></column>
            <column name="INVENTORY_ITEM_ID" type="UUID"><constraints nullable="true" foreignKeyName="FK_FILE_INVENTORY_ITEM" references="INVENTORY_ITEM(ID)"/></column>
            <column name="FILENAME" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="ABSOLUTE_PATH" type="TEXT"><constraints nullable="false"/></column>
            <column name="RELATIVE_PATH" type="TEXT"><constraints nullable="false"/></column>
            <column name="IS_DIRECTORY" type="BOOLEAN" defaultValueBoolean="false"><constraints nullable="false"/></column>
            <column name="REVIEWED" type="BOOLEAN" defaultValueBoolean="false"><constraints nullable="false"/></column>
            <column name="CREATED_DATE" type="DATETIME"/>
            <column name="LAST_MODIFIED_DATE" type="DATETIME"/>
            <column name="CREATED_BY" type="VARCHAR(255)"/>
            <column name="LAST_MODIFIED_BY" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>

    <changeSet id="FILE_INDEXES" author="OcctetFrontend" runAlways="true">
        <sql>
            CREATE INDEX IF NOT EXISTS IDX_FILE_PARENT ON FILE (PARENT_ID);
            CREATE INDEX IF NOT EXISTS IDX_FILE_PROJECT_PARENT ON FILE (PROJECT_ID, PARENT_ID);
            CREATE INDEX IF NOT EXISTS IDX_FILE_PROJECT_REVIEWED ON FILE (PROJECT_ID, REVIEWED);
        </sql>
    </changeSet>

    <changeSet id="CONFIGURATION" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="CONFIGURATION"/></not></preConditions>
        <createTable tableName="CONFIGURATION">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CONFIGURATION"/>
            </column>
            <column name="NAME" type="VARCHAR(255)"/>
            <column name="VALUE" type="VARCHAR(255)"/>
            <column name="UPLOAD" type="BINARY"/>
            <column name="SCANNER_INITIALIZER_ID" type="UUID"/>
        </createTable>
    </changeSet>

    <changeSet id="SUGGESTION" author="OcctetFrontend" runAlways="true">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SUGGESTION"/></not></preConditions>
        <createTable tableName="SUGGESTION">
            <column name="ID" type="UUID"></column>
            <column name="CONTEXT" type="VARCHAR(255)"/>
            <column name="SENTENCE" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="CREATION_INFO_ENTITY" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="CREATION_INFO_ENTITY"/></not></preConditions>
        <createTable tableName="CREATION_INFO_ENTITY">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_CREATION_INFO_ENTITY"/></column>
            <column name="CREATED" type="VARCHAR(255)"/>
            <column name="CREATORS" type="TEXT"/>
            <column name="LICENSE_LIST_VERSION" type="VARCHAR(255)"/>
            <column name="COMMENT" type="TEXT"/>
        </createTable>
    </changeSet>

    <changeSet id="SPDX_DOCUMENT_ROOT" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SPDX_DOCUMENT_ROOT"/></not></preConditions>
        <createTable tableName="SPDX_DOCUMENT_ROOT">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_SPDX_DOCUMENT_ROOT"/></column>
            <column name="SPDX_ID" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="SPDX_VERSION" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="DATA_LICENSE" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="NAME" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="COMMENT" type="TEXT"/>
            <column name="DOCUMENT_URI" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="CREATION_INFO_ID" type="BIGINT"><constraints nullable="false"/></column>
        </createTable>
        <addForeignKeyConstraint baseTableName="SPDX_DOCUMENT_ROOT" baseColumnNames="CREATION_INFO_ID" constraintName="FK_SPDX_DOC_CREATION_INFO" referencedTableName="CREATION_INFO_ENTITY" referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="SPDX_PACKAGE_ENTITY" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SPDX_PACKAGE_ENTITY"/></not></preConditions>
        <createTable tableName="SPDX_PACKAGE_ENTITY">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_SPDX_PACKAGE_ENTITY"/></column>
            <column name="SPDX_ID" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="NAME" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="DOWNLOAD_LOCATION" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="FILES_ANALYZED" type="BOOLEAN"/>
            <column name="VERSION_INFO" type="TEXT"/>
            <column name="LICENSE_CONCLUDED" type="TEXT"/>
            <column name="LICENSE_DECLARED" type="TEXT"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
            <column name="HOMEPAGE" type="TEXT"/>
            <column name="SUMMARY" type="TEXT"/>
            <column name="DESCRIPTION" type="TEXT"/>
            <column name="ORIGINATOR" type="TEXT"/>
            <column name="SUPPLIER" type="TEXT"/>
            <column name="PACKAGE_VERIFICATION_CODE_VALUE" type="VARCHAR(255)"><constraints nullable="false"/></column>
        </createTable>
        <addForeignKeyConstraint baseTableName="SPDX_PACKAGE_ENTITY" baseColumnNames="SPDX_DOCUMENT_ID" constraintName="FK_SPDX_PACKAGE_DOC" referencedTableName="SPDX_DOCUMENT_ROOT" referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="SPDX_FILE_ENTITY" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SPDX_FILE_ENTITY"/></not></preConditions>
        <createTable tableName="SPDX_FILE_ENTITY">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_SPDX_FILE_ENTITY"/></column>
            <column name="SPDX_ID" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="FILE_NAME" type="TEXT"><constraints nullable="false"/></column>
            <column name="LICENSE_CONCLUDED" type="TEXT"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="SPDX_FILE_ENTITY" baseColumnNames="SPDX_DOCUMENT_ID" constraintName="FK_SPDX_FILE_DOC" referencedTableName="SPDX_DOCUMENT_ROOT" referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="SPDX_LIST_TABLES" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="PACKAGE_LICENSE_INFO_FROM_FILES"/></not></preConditions>
        <createTable tableName="PACKAGE_LICENSE_INFO_FROM_FILES">
            <column name="PACKAGE_ID" type="BIGINT"><constraints nullable="false"/></column>
            <column name="LICENSE_INFO_FROM_FILES" type="TEXT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="PACKAGE_LICENSE_INFO_FROM_FILES" baseColumnNames="PACKAGE_ID" constraintName="FK_PKG_LIC_INFO_PKG" referencedTableName="SPDX_PACKAGE_ENTITY" referencedColumnNames="ID"/>

        <createTable tableName="PACKAGE_FILE_NAMES">
            <column name="PACKAGE_ID" type="BIGINT"><constraints nullable="false"/></column>
            <column name="FILE_NAME" type="VARCHAR(255)"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="PACKAGE_FILE_NAMES" baseColumnNames="PACKAGE_ID" constraintName="FK_PKG_FILE_NAMES_PKG" referencedTableName="SPDX_PACKAGE_ENTITY" referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="SNIPPET" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="SNIPPET"/></not></preConditions>
        <createTable tableName="SNIPPET">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_SNIPPET"/></column>
            <column name="SPDX_ID" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"><constraints nullable="false"/></column>
            <column name="NAME" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="SNIPPET_FROM_FILE" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="LICENSE_CONCLUDED" type="TEXT"/>
            <column name="COPYRIGHT_TEXT" type="TEXT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="SNIPPET" baseColumnNames="SPDX_DOCUMENT_ID" constraintName="FK_SNIPPET_DOC" referencedTableName="SPDX_DOCUMENT_ROOT" referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="RELATIONSHIP_ENTITY" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="RELATIONSHIP_ENTITY"/></not></preConditions>
        <createTable tableName="RELATIONSHIP_ENTITY">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_RELATIONSHIP_ENTITY"/></column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="SPDX_ELEMENT_ID" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="RELATED_SPDX_ELEMENT" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="RELATIONSHIP_TYPE" type="VARCHAR(255)"><constraints nullable="false"/></column>
            <column name="COMMENT" type="TEXT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="RELATIONSHIP_ENTITY" baseColumnNames="SPDX_DOCUMENT_ID" constraintName="FK_RELATIONSHIP_DOC" referencedTableName="SPDX_DOCUMENT_ROOT" referencedColumnNames="ID"/>
    </changeSet>

    <changeSet id="ANNOTATION_ENTITY" author="OcctetBackend">
        <preConditions onFail="MARK_RAN"><not><tableExists tableName="ANNOTATION_ENTITY"/></not></preConditions>
        <createTable tableName="ANNOTATION_ENTITY">
            <column name="ID" type="BIGINT"><constraints nullable="false" primaryKey="true" primaryKeyName="PK_ANNOTATION_ENTITY"/></column>
            <column name="SPDX_DOCUMENT_ID" type="BIGINT"/>
            <column name="SPDX_PACKAGE_ID" type="BIGINT"/>
            <column name="SPDX_FILE_ID" type="BIGINT"/>
            <column name="ANNOTATOR" type="VARCHAR(255)"/>
            <column name="ANNOTATION_DATE" type="VARCHAR(255)"/>
            <column name="ANNOTATION_TYPE" type="VARCHAR(255)"/>
            <column name="COMMENT" type="TEXT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="ANNOTATION_ENTITY" baseColumnNames="SPDX_PACKAGE_ID" constraintName="FK_ANNOTATION_PACKAGE" referencedTableName="SPDX_PACKAGE_ENTITY" referencedColumnNames="ID"/>
    </changeSet>


    <changeSet id="create-file-license-info" author="you">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="file_license_info"/>
            </not>
        </preConditions>

        <createTable tableName="file_license_info">
            <column name="spdx_file_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>

            <column name="license_info_in_files" type="TEXT">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint
                baseTableName="file_license_info"
                baseColumnNames="spdx_file_id"
                referencedTableName="spdx_file_entity"
                referencedColumnNames="id"
                constraintName="fk_file_license_file"/>
    </changeSet>

</databaseChangeLog>