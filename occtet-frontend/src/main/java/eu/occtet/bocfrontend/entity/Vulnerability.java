/*
 *
 *  Copyright (C) 2025 Bitsea GmbH
 *  *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *
 *  SPDX-License-Identifier: Apache-2.0
 *  License-Filename: LICENSE
 * /
 *
 */

package eu.occtet.bocfrontend.entity;


import eu.occtet.bocfrontend.converter.ListStringConverter;
import io.jmix.core.entity.annotation.JmixGeneratedValue;
import io.jmix.core.metamodel.annotation.InstanceName;
import io.jmix.core.metamodel.annotation.JmixEntity;
import jakarta.annotation.Nonnull;
import jakarta.persistence.*;

import java.time.LocalDateTime;
import java.util.List;
import java.util.UUID;

@Entity
@Table(name = "VULNERABILITY")
@JmixEntity
public class Vulnerability {

    @Id
    @Column(name = "ID", nullable = false)
    @JmixGeneratedValue
    private UUID id;

    @Column(name = "VULNERABILITY_ID", nullable = false)
    @InstanceName
    private String vulnerabilityId;

    @Column(name = "SUMMARY", columnDefinition = "TEXT")
    private String summary;

    @Column(name = "ALIASES", columnDefinition = "TEXT")
    @Convert(converter = ListStringConverter.class)
    private List<String> aliases;

    @Column(name = "WEIGHTED_SEVERITY")
    private Double weightedSeverity;

    @Column(name = "exploitability")
    private Double exploitability;

    @Column(name = "RISK_SCORE")
    private Double riskScore;

    @Column(name = "FIXED_PACKAGES", columnDefinition = "TEXT")
    @Convert(converter = ListStringConverter.class)
    private List<String> fixedPackages;

    @Column(name = "SOURCE_URL")
    private String sourceUrl;

    @Column(name = "REFRENCE_URLS", columnDefinition = "TEXT")
    @Convert(converter = ListStringConverter.class)
    private List<String> references;

    @Column(name = "CREATED_AT", updatable = false)
    private @Nonnull LocalDateTime createdAt;

    public Vulnerability() {}

    public Vulnerability(String vulnerabilityId, String summary, List<String> aliases,
                         Double weightedSeverity, Double exploitability, Double riskScore,
                         List<String> fixedPackages, String sourceUrl, List<String> references) {
        this.vulnerabilityId = vulnerabilityId;
        this.summary = summary;
        this.aliases = aliases;
        this.weightedSeverity = weightedSeverity;
        this.exploitability = exploitability;
        this.riskScore = riskScore;
        this.fixedPackages = fixedPackages;
        this.sourceUrl = sourceUrl;
        this.references = references;
    }

    public UUID getId() {
        return id;
    }

    public void setId(UUID id) {
        this.id = id;
    }

    public String getVulnerabilityId() {
        return vulnerabilityId;
    }

    public void setVulnerabilityId(String vulnerabilityId) {
        this.vulnerabilityId = vulnerabilityId;
    }

    public String getSummary() {
        return summary;
    }

    public void setSummary(String summary) {
        this.summary = summary;
    }

    public List<String> getAliases() {
        return aliases;
    }

    public void setAliases(List<String> aliases) {
        this.aliases = aliases;
    }

    public Double getWeightedSeverity() {
        return weightedSeverity;
    }

    public void setWeightedSeverity(Double weightedSeverity) {
        this.weightedSeverity = weightedSeverity;
    }

    public Double getRiskScore() {
        return riskScore;
    }

    public void setRiskScore(Double riskScore) {
        this.riskScore = riskScore;
    }

    public List<String> getFixedPackages() {
        return fixedPackages;
    }

    public void setFixedPackages(List<String> fixedPackages) {
        this.fixedPackages = fixedPackages;
    }

    @Nonnull
    public LocalDateTime getCreatedAt() {
        return createdAt;
    }

    public void setCreatedAt(@Nonnull LocalDateTime createdAt) {
        this.createdAt = createdAt;
    }

    public Double getExploitability() {
        return exploitability;
    }

    public void setExploitability(Double exploitability) {
        this.exploitability = exploitability;
    }

    public String getSourceUrl() {
        return sourceUrl;
    }

    public void setSourceUrl(String sourceUrl) {
        this.sourceUrl = sourceUrl;
    }

    public List<String> getReferences() {
        return references;
    }

    public void setReferences(List<String> references) {
        this.references = references;
    }
}
